➜ jonatan@prestige-15-a10sc  ~/Documentos/Master_Devops/Herramientas_DevOps/herramientas_devops/actividad1 git:(main) ✗ packer build aws-ubuntu-hello-node.pkr.hcl              
amazon-ebs.hello-node-jonatan: output will be in this color.

==> amazon-ebs.hello-node-jonatan: Prevalidating any provided VPC information
==> amazon-ebs.hello-node-jonatan: Prevalidating AMI Name: hello-node-jonatan
    amazon-ebs.hello-node-jonatan: Found Image ID: ami-0230aba74330fed22
==> amazon-ebs.hello-node-jonatan: Creating temporary keypair: packer_61cf532c-34bd-182f-d328-eb192cb6cc94
==> amazon-ebs.hello-node-jonatan: Creating temporary security group for this instance: packer_61cf5331-5120-404c-7cae-2e15c7b85eaa
==> amazon-ebs.hello-node-jonatan: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...
==> amazon-ebs.hello-node-jonatan: Launching a source AWS instance...
==> amazon-ebs.hello-node-jonatan: Adding tags to source instance
    amazon-ebs.hello-node-jonatan: Adding tag: "Name": "Packer Builder"
    amazon-ebs.hello-node-jonatan: Instance ID: i-07de54e30ba7585bc
==> amazon-ebs.hello-node-jonatan: Waiting for instance (i-07de54e30ba7585bc) to become ready...
==> amazon-ebs.hello-node-jonatan: Using SSH communicator to connect: 34.227.117.92
==> amazon-ebs.hello-node-jonatan: Waiting for SSH to become available...
==> amazon-ebs.hello-node-jonatan: Connected to SSH!
==> amazon-ebs.hello-node-jonatan: Provisioning with Ansible...
    amazon-ebs.hello-node-jonatan: Setting up proxy adapter for Ansible....
==> amazon-ebs.hello-node-jonatan: Executing Ansible: ansible-playbook -e packer_build_name="hello-node-jonatan" -e packer_builder_type=amazon-ebs --ssh-extra-args '-o IdentitiesOnly=yes' -e ansible_ssh_private_key_file=/tmp/ansible-key585239958 -i /tmp/packer-provisioner-ansible116870163 /home/jonatan/Documentos/Master_Devops/Herramientas_DevOps/herramientas_devops/actividad1/node-playbook.yaml
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY [Provision Node App] ******************************************************
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Gathering Facts] *********************************************************
    amazon-ebs.hello-node-jonatan: ok: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Wait 8 seconds for APT to complete on AWS instances] *********************
    amazon-ebs.hello-node-jonatan: Pausing for 8 seconds
    amazon-ebs.hello-node-jonatan: (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
    amazon-ebs.hello-node-jonatan: ok: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Remove list lock] ********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Install packages] ********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Install pm2 package globally] ********************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Creates app directory] ***************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Copy JS app to app directory] ********************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Kills PM2 processes] *****************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Starts PM2 on startup] ***************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Starts PM2 app] **********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan: [WARNING]: Consider using 'become', 'become_method', and 'become_user' rather
    amazon-ebs.hello-node-jonatan: than running sudo
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Starts JS app] ***********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Saves PM2 state] *********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY RECAP *********************************************************************
    amazon-ebs.hello-node-jonatan: default                    : ok=12   changed=10   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
    amazon-ebs.hello-node-jonatan:
==> amazon-ebs.hello-node-jonatan: Provisioning with Ansible...
    amazon-ebs.hello-node-jonatan: Setting up proxy adapter for Ansible....
==> amazon-ebs.hello-node-jonatan: Executing Ansible: ansible-playbook -e packer_build_name="hello-node-jonatan" -e packer_builder_type=amazon-ebs --ssh-extra-args '-o IdentitiesOnly=yes' -e ansible_ssh_private_key_file=/tmp/ansible-key2207046632 -i /tmp/packer-provisioner-ansible3221640122 /home/jonatan/Documentos/Master_Devops/Herramientas_DevOps/herramientas_devops/actividad1/nginx-playbook.yaml
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY [Provision Nginx] *********************************************************
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Gathering Facts] *********************************************************
    amazon-ebs.hello-node-jonatan: ok: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Disable apache service] **************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Install packages] ********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Delete default nginx configuration file] *********************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Copy Nginx custom configuration as the default configuration] ************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Validates new configuration] *********************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Reload nginx config] *****************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY RECAP *********************************************************************
    amazon-ebs.hello-node-jonatan: default                    : ok=7    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
    amazon-ebs.hello-node-jonatan:
==> amazon-ebs.hello-node-jonatan: Provisioning with Ansible...
    amazon-ebs.hello-node-jonatan: Setting up proxy adapter for Ansible....
==> amazon-ebs.hello-node-jonatan: Executing Ansible: ansible-playbook -e packer_build_name="hello-node-jonatan" -e packer_builder_type=amazon-ebs --ssh-extra-args '-o IdentitiesOnly=yes' -e ansible_ssh_private_key_file=/tmp/ansible-key992281104 -i /tmp/packer-provisioner-ansible1113782626 /home/jonatan/Documentos/Master_Devops/Herramientas_DevOps/herramientas_devops/actividad1/metrics-playbook.yaml
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY [Provision metricbeat and filebeat] ***************************************
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Gathering Facts] *********************************************************
    amazon-ebs.hello-node-jonatan: ok: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Add Elasticsearch Apt key] ***********************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Add Elasticsearch repository.] *******************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Install packages] ********************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Enable metricbeat services] **********************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: TASK [Enable filebeat services] ************************************************
    amazon-ebs.hello-node-jonatan: changed: [default]
    amazon-ebs.hello-node-jonatan:
    amazon-ebs.hello-node-jonatan: PLAY RECAP *********************************************************************
    amazon-ebs.hello-node-jonatan: default                    : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
    amazon-ebs.hello-node-jonatan:
==> amazon-ebs.hello-node-jonatan: Stopping the source instance...
    amazon-ebs.hello-node-jonatan: Stopping instance
==> amazon-ebs.hello-node-jonatan: Waiting for the instance to stop...
==> amazon-ebs.hello-node-jonatan: Creating AMI hello-node-jonatan from instance i-07de54e30ba7585bc
    amazon-ebs.hello-node-jonatan: AMI: ami-0918245a959c9e8e3
==> amazon-ebs.hello-node-jonatan: Waiting for AMI to become ready...
==> amazon-ebs.hello-node-jonatan: Skipping Enable AMI deprecation...
==> amazon-ebs.hello-node-jonatan: Terminating the source AWS instance...
==> amazon-ebs.hello-node-jonatan: Cleaning up any extra volumes...
==> amazon-ebs.hello-node-jonatan: No volumes to clean up, skipping
==> amazon-ebs.hello-node-jonatan: Deleting temporary security group...
==> amazon-ebs.hello-node-jonatan: Deleting temporary keypair...
==> amazon-ebs.hello-node-jonatan: Running post-processor:  (type manifest)
Build 'amazon-ebs.hello-node-jonatan' finished after 8 minutes 11 seconds.

==> Wait completed after 8 minutes 11 seconds

==> Builds finished. The artifacts of successful builds are:
--> amazon-ebs.hello-node-jonatan: AMIs were created:
us-east-1: ami-0918245a959c9e8e3

--> amazon-ebs.hello-node-jonatan: AMIs were created:
us-east-1: ami-0918245a959c9e8e3